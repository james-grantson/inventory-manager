"use client"

import { useEffect, useState } from 'react'

export default function Home() {
  const [health, setHealth] = useState({ status: 'checking', message: '' })
  const [apiUrl, setApiUrl] = useState('')

  useEffect(() => {
    // Get API URL from environment variable
    const url = process.env.NEXT_PUBLIC_API_URL || 'https://inventory-manager-api-ghana.vercel.app'
    setApiUrl(url)
    
    fetch(`${url}/api/health`)
      .then(response => {
        if (!response.ok) throw new Error(`HTTP ${response.status}`)
        return response.json()
      })
      .then(data => {
        setHealth({ status: 'healthy', message: data.message })
      })
      .catch((error) => {
        console.error('API Error:', error)
        setHealth({ 
          status: 'unhealthy', 
          message: `Cannot connect to backend: ${error.message}` 
        })
      })
  }, [])

  return (
    <div className="max-w-4xl mx-auto">
      <div className="bg-white rounded-xl shadow-lg p-6">
        <h1 className="text-3xl font-bold text-gray-800 mb-4">Inventory Manager - Live System</h1>
        
        <div className={`p-4 rounded-lg mb-6 ${health.status === 'healthy' ? 'bg-green-50 border border-green-200' : 'bg-red-50 border border-red-200'}`}>
          <h3 className="font-semibold">
            Backend Status: {health.status === 'healthy' ? '✅ Connected' : '❌ Not Connected'}
          </h3>
          <p className="text-sm text-gray-600">{health.message}</p>
          <p className="text-xs text-gray-500 mt-1">
            Trying to connect to: {apiUrl}
          </p>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div className="bg-blue-50 p-4 rounded-lg border border-blue-200">
            <h3 className="font-semibold text-blue-700">Frontend</h3>
            <p className="text-gray-600">Next.js 14 (Vercel)</p>
            <p className="text-xs text-gray-500">
              <a href="https://inventory-manager-frontend-ghana.vercel.app" target="_blank" className="text-blue-600 hover:underline">
                Open Live App
              </a>
            </p>
          </div>
          
          

      <div className="bg-green-50 p-4 rounded-lg border border-green-200">
            <h3 className="font-semibold text-green-700">Backend API</h3>
            <p className="text-gray-600">Express.js (Vercel)</p>
            <p className="text-xs text-gray-500">
              <a href="https://inventory-manager-api-ghana.vercel.app/api/health" target="_blank" className="text-green-600 hover:underline">
                Test API
              </a>
            </p>
          </div>
          
          <div className="bg-purple-50 p-4 rounded-lg border border-purple-200">
            <h3 className="font-semibold text-purple-700">Database</h3>
            <p className="text-gray-600">Supabase PostgreSQL</p>
            <p className="text-xs text-gray-500">Ready for connection</p>
          </div>
        </div>

        <div className="mt-8 p-4 bg-gray-50 rounded-lg">
          <h4 className="font-semibold mb-2">Troubleshooting Backend Connection</h4>
          <ul className="text-sm text-gray-600 space-y-1">
            <li>1. Test backend directly: 
              <a href="https://inventory-manager-api-ghana.vercel.app/api/health" target="_blank" className="ml-2 text-blue-600 hover:underline">
                https://inventory-manager-api-ghana.vercel.app/api/health
              </a>
            </li>
            <li>2. Check backend logs: 
              <code className="ml-2 bg-gray-200 px-1 rounded text-xs">npx vercel logs https://inventory-manager-api-ghana.vercel.app</code>
            </li>
            <li>3. Redeploy backend if needed</li>
          </ul>
        </div>
      </div>
    </div>
  )
}


